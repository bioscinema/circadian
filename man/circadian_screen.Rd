% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/period_screen.R
\name{circadian_screen}
\alias{circadian_screen}
\title{screen_circadian_24h}
\usage{
circadian_screen(
  Y,
  time,
  id = NULL,
  covariates = NULL,
  method = c("gls", "cosinor"),
  cor_struct = c("ar1", "none"),
  trend_df = 3,
  periods = seq(20, 28, by = 0.25),
  peak_tol = 0.5,
  contrast = c("bic", "aic"),
  delta_ic_thresh = -4,
  use_permutation = FALSE,
  B = 499,
  seed = NULL,
  p_adjust = c("BH", "BY", "bonferroni", "holm", "hochberg", "hommel", "fdr", "qvalue",
    "none"),
  alpha = 0.05,
  save_plots = FALSE,
  plot_dir = NULL,
  return_plots = FALSE,
  verbose = TRUE
)
}
\arguments{
\item{Y}{numeric matrix (genes x samples). Rows = genes/features, cols = samples.}

\item{time}{numeric vector length n (in hours). Sampling time for each sample.}

\item{id}{optional factor/character length n: replicate/batch/subject ID
(used to scope AR(1) correlation and circular-shift permutation).}

\item{covariates}{optional data.frame (n x p) of additional covariates.}

\item{method}{"cosinor" or "gls". cosinor uses OLS (stats::lm), gls uses nlme::gls.}

\item{cor_struct}{correlation structure for GLS: "none" or "ar1". Ignored for cosinor.}

\item{trend_df}{integer >=0. If >0, include slow trend via splines::ns(time, df=trend_df).}

\item{periods}{numeric vector of candidate periods (hours) for neighborhood profile.}

\item{peak_tol}{numeric. Require |peak_period - 24| <= peak_tol to pass specificity S1.}

\item{contrast}{"bic" or "aic". Use information criterion to compare 24h vs best alt.}

\item{delta_ic_thresh}{numeric (default -4). Require IC(24) - IC(alt) <= thresh to pass S2.}

\item{use_permutation}{logical. If TRUE, compute circular-shift permutation p-values.}

\item{B}{integer. Number of permutations.}

\item{seed}{optional integer seed for reproducibility of permutations.}

\item{p_adjust}{multiple testing method: one of p.adjust methods ("BH","BY","bonferroni",
"holm", etc.), "qvalue" (requires qvalue package), or "none".}

\item{alpha}{numeric in (0,1]. Significance level for binary call.}

\item{save_plots}{logical. If TRUE, save per-gene plots to \code{plot_dir}.}

\item{plot_dir}{character dir to save plots when save_plots=TRUE.}

\item{return_plots}{logical. If TRUE, return ggplot objects in the result.}

\item{verbose}{logical. Print progress.}
}
\value{
a list with elements:
\itemize{
\item results: data.frame with per-gene statistics and binary decision \code{is_24h}.
\item overlay_plots: named list of ggplot (if return_plots=TRUE).
\item profile_plots: named list of ggplot (if return_plots=TRUE).
\item params: a list of key settings used.
}
}
\description{
High-throughput 24-hour circadian screening with options for Cosinor/GLS,
neighborhood profile, local period-contrast, circular-shift permutation,
and multiple testing correction. Returns per-gene results and (optionally)
per-gene plots: fitted overlay and neighborhood profile.
}

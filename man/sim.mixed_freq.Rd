% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sim.mixed_freq.R
\name{sim.mixed_freq}
\alias{sim.mixed_freq}
\title{Simulate Mixed-Period Circadian Gene Expression Data}
\usage{
sim.mixed_freq(
  m = 1000,
  times = NULL,
  time_mode = c("uniform", "nonuniform"),
  uniform_start = 0,
  uniform_by = 1,
  uniform_length = 24,
  nonuniform_start = 0,
  nonuniform_end = 24,
  nonuniform_n = 24,
  periods = c(24, 17, 11, 35, NA),
  frac = rep(1/5, 5),
  A_range = c(0.8, 2),
  c_mean_sd = c(10, 2),
  sigma = 1,
  seed = 2025
)
}
\arguments{
\item{m}{Integer. Number of genes (rows) to simulate. Default is 1000.}

\item{times}{Optional numeric vector of sampling times (in hours). If \code{NULL}, the time points
are generated according to \code{time_mode}.}

\item{time_mode}{Character. Either "uniform" or "nonuniform".
\itemize{
\item "uniform": equally spaced times specified by uniform_start, uniform_by, uniform_length.
\item "nonuniform": random sampling within \link{nonuniform_start, nonuniform_end} with nonuniform_n samples.
}}

\item{uniform_start, uniform_by, uniform_length}{Numeric. Parameters controlling the evenly spaced time grid
when time_mode = "uniform".}

\item{nonuniform_start, nonuniform_end}{Numeric. Range for randomly sampled times when
time_mode = "nonuniform".}

\item{nonuniform_n}{Integer. Number of samples when generating non-uniform times.}

\item{periods}{Numeric vector. A set of oscillation periods (in hours) assigned to rhythmic genes.
Can include \code{NA} to represent non-rhythmic genes.}

\item{frac}{Numeric vector of the same length as \code{periods}, giving the fraction of genes
assigned to each period type. Must sum to 1.}

\item{A_range}{Numeric length-2 vector. Range of amplitudes for rhythmic genes. Default is \code{c(0.8, 2.0)}.}

\item{c_mean_sd}{Numeric length-2 vector. Mean and standard deviation of the baseline expression level.
Default is \code{c(10, 2)}.}

\item{sigma}{Numeric. Standard deviation of Gaussian noise added to each expression value.}

\item{seed}{Integer. Random seed for reproducibility.}
}
\value{
A list with the following elements:
\describe{
\item{expr}{Matrix of simulated expression values (genes Ã— samples).}
\item{time}{Vector of sampling times.}
\item{type}{Character vector labeling each gene type (\code{"p24"}, \code{"p17"}, \code{"nor"}, etc.).}
\item{phi}{Vector of phase shifts (radians).}
\item{period_true}{Vector of true periods assigned to each gene.}
\item{meta}{List containing all simulation parameters.}
}
}
\description{
Generate synthetic gene expression matrices containing a mixture of rhythmic and non-rhythmic genes
with user-defined oscillation periods, amplitudes, and noise. The function allows both uniformly
and non-uniformly spaced sampling times, providing flexible simulation settings for benchmarking
circadian analysis methods.
}
\details{
Each gene is simulated according to the following model:
\deqn{
Y_{ij} = c_{0i} + A_i \sin\left(\frac{2\pi t_j}{P_i} + \phi_i\right) + \epsilon_{ij},
}
where \(t_j\) is the sampling time, \(A_i\) is amplitude, \(c_{0i}\) is baseline expression,
\(P_i\) is period (possibly \code{NA} for non-rhythmic genes), and \(\epsilon_{ij}\sim N(0, \sigma^2)\).
}
\examples{
# Example 1: Default settings with uniform time grid
sim <- simulate_mix_periods()
dim(sim$expr)

# Example 2: Non-uniform time sampling
sim2 <- simulate_mix_periods(time_mode = "nonuniform", sigma = 0.5)
plot(sim2$time, sim2$expr[1, ], type = "l", main = sim2$type[1])

}
